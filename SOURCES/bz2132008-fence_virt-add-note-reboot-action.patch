From d664c254608c9342785f92d3da2ff6ba2466df3b Mon Sep 17 00:00:00 2001
From: Oyvind Albrigtsen <oalbrigt@redhat.com>
Date: Tue, 4 Oct 2022 13:43:13 +0200
Subject: [PATCH] fence_virt: add note that reboot-action doesnt power on nodes
 that are powered off

---
 agents/virt/client/options.c       | 7 ++++---
 tests/data/metadata/fence_virt.xml | 4 +++-
 2 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/agents/virt/client/options.c b/agents/virt/client/options.c
index ff624481b..ddd6bc4e0 100644
--- a/agents/virt/client/options.c
+++ b/agents/virt/client/options.c
@@ -734,9 +734,9 @@ args_usage(char *progname, const char *optstr, int print_stdin)
 
 	if (!print_stdin) {
 		if (progname) {
-			printf("usage: %s [args]\n", progname);
+			printf("usage: %s [args]\n\nNOTE: reboot-action does not power on nodes that are powered off.\n\n", progname);
 		} else {
-			printf("usage: fence_virt [args]\n");
+			printf("usage: fence_virt [args]\n\nNOTE: reboot-action does not power on nodes that are powered off.\n\n");
 		}
 	}
 
@@ -766,7 +766,8 @@ args_metadata(char *progname, const char *optstr)
 	printf("<?xml version=\"1.0\" ?>\n");
 	printf("<resource-agent name=\"%s\" shortdesc=\"Fence agent for virtual machines\">\n", basename(progname));
 	printf("<longdesc>%s is an I/O Fencing agent which can be used with "
-	       "virtual machines.</longdesc>\n", basename(progname));
+	       "virtual machines.\n\nNOTE: reboot-action does not power on nodes that are powered off."
+	       "</longdesc>\n", basename(progname));
 	printf("<vendor-url>https://libvirt.org</vendor-url>\n");
 	printf("<parameters>\n");
 
diff --git a/tests/data/metadata/fence_virt.xml b/tests/data/metadata/fence_virt.xml
index eb1959a11..612d4d3cb 100644
--- a/tests/data/metadata/fence_virt.xml
+++ b/tests/data/metadata/fence_virt.xml
@@ -1,6 +1,8 @@
 <?xml version="1.0" ?>
 <resource-agent name="fence_virt" shortdesc="Fence agent for virtual machines">
-<longdesc>fence_virt is an I/O Fencing agent which can be used with virtual machines.</longdesc>
+<longdesc>fence_virt is an I/O Fencing agent which can be used with virtual machines.
+
+NOTE: reboot-action does not power on nodes that are powered off.</longdesc>
 <vendor-url>https://libvirt.org</vendor-url>
 <parameters>
 	<parameter name="debug" unique="0" required="0">
